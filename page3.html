<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ΒΑΘΜΟΛΟΓΙΑ & ΑΠΑΝΤΗΣΕΙΣ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <div class="container">
        <div class="navbar">
            <div class="logo">Βαθμολογία & Απαντήσεις</div>
        </div>

        <section class="purpose">
            <h1>Ανά Ερωτηματολόγιο</h1>
            <ul id="individualScores" style="list-style: none; padding-left: 0;"></ul>

            <div class="spinner-wrapper" id="loadingSpinner1" style="display: flex; justify-content: center;">
                <div class="spinner"></div>
            </div>
            
            <h1>Συνολική Βαθμολογία</h1>  
            <p id="totalScore"></p>

            <div class="spinner-wrapper" id="loadingSpinner2" style="display: flex; justify-content: center;">
                <div class="spinner"></div>
            </div>
            
            <h2>Πίνακας Αποτελεσμάτων</h2>
            <table border="1" cellspacing="0" cellpadding="8" style="width: 100%; border-collapse: collapse; text-align: center;">
                <thead style="background-color: #f2f2f2;">
                    <tr>
                        <th>Κατηγορία</th>
                        <th>Χαμηλό Επίπεδο Ωριμότητας</th>
                        <th>Μέτριο Επίπεδο Ωριμότητας</th>
                        <th>Υψηλό Επίπεδο Ωριμότητας</th>
                    </tr>
                </thead>
                <tbody style="background-color: #f2f2f2;">
                    <tr>
                        <td>Ανθρωποκεντρικότητα</td>
                        <td> 9 - 20</td>
                        <td>21 - 32</td>
                        <td>33 - 45</td>
                    </tr>
                    <tr>
                        <td>Κλινική Αποτελεσματικότητα</td>
                        <td> 4 - 9</td>
                        <td>10 - 15</td>
                        <td>16 - 20</td>
                    </tr>
                    <tr>
                        <td>Ασφάλεια - Απόρρητο</td>
                        <td> 3 - 7</td>
                        <td> 8 - 11</td>
                        <td>12 - 15</td>
                    </tr>

                    <tr>
                        <td><b>ΣΥΝΟΛΙΚΑ</b></td>
                        <td><b>16 - 36</b></td>
                        <td><b>37 - 59</b></td>
                        <td><b>60 - 80</b></td>
                    </tr>                
                </tbody>
            </table>
        </section>

        <section class="purpose">
            <h2>Αναλυτικές Απαντήσεις</h2>
            <div id="answersDisplay"></div>
            <div class="spinner-wrapper" id="loadingSpinner3" style="display: flex; justify-content: center;">
                <div class="spinner"></div>
            </div>
            
            <div class="export-buttons">
                <button onclick="exportToCSV()">Εξαγωγή σε CSV</button>
                <button onclick="exportToPDF()">Εξαγωγή σε PDF</button>
                <button onclick="exportToTXT()">Εξαγωγή σε TXT</button>

            </div>

            <p class="switch-page">
                    Για να μεταβείτε στα στατιστικά πατήστε <a href="page4.html">εδώ</a>.
            </p>
        </section>
</div>

    <script>

        let fetchedAnswers = [];
        const questionTitles = {
            q1: "Ικανοποίηση – Εμπειρία – Αποδοχή",
            q2: "Κατανόηση των Πληροφοριών και Εμπιστοσύνη",
            q3: "Ικανότητα Χρήσης της Εφαρμογής – Προσβασιμότητα",
            q4: "Τεχνολογική Υποδομή",
            q5: "Ψηφιακός Αλφαβητισμός",
            q6: "Επικοινωνία",
            q7: "Πρόσβαση στην Φροντίδα για Ασθενείς, Οικογένεια και / ή Φροντιστές",
            q8: "Εμπειρία των Μελών της Ομάδας Φροντίδας",
            q9: "Ηθικές Αρχές - Προώθηση και Μάρκετινγκ",
            q10: "Ετοιμότητα Εργατικού Δυναμικού",
            q11: "Διαγνωστική Ακρίβεια",
            q12: "Επιπτώσεις στη Θνησιμότητα, στη Νοσηρότητα, στην HRQoL, καθώς και στις Συνήθειες - Συμπεριφορές",
            q13: "Χρήση Υπηρεσιών Υγείας",
            q14: "Λειτουργική Ακεραιότητα και Ακεραιότητα Υποδομών",
            q15: "Ψυχολογική και Συναισθηματική Ασφάλεια",
            q16: "Διακυβέρνηση"
        };

        const answerTexts = {
            q1: {
                "1": "Δεν υπάρχει καμία καθοδήγηση ή μηχανισμός.",
                "2": "Υπάρχει σαφής καθοδήγηση από τον οργανισμό σχετικά με την εμπειρία των ασθενών από τις υπηρεσίες τηλεϊατρικής, καθώς και ενημέρωση των ασθενών για τις υπηρεσίες υγείας.",
                "3": "Η καθοδήγηση από τον οργανισμό και η ενημέρωση των ασθενών είναι εναρμονισμένες με την εθνική καθοδήγηση ή υπάρχει σχετική έκθεση στον οργανισμό, η οποία αφορά ειδικά τις υπηρεσίες τηλε-υγείας.",
                "4": "Υπάρχουν κατευθυντήριες οδηγίες και ένας μηχανισμός για την εφαρμογή της συλλογής εθνικά εγκεκριμένων μετρήσεων σχετικά με την εμπειρία και την αποδοχή των ασθενών.",
                "5": "Ο οργανισμός πληροί όλα τα κριτήρια και διερευνά ή χρησιμοποιεί συστηματικά ψηφιακά εργαλεία για την καταγραφή της εμπειρίας των ασθενών εκτός από άλλες μορφές έρευνας σχετικά με την εμπειρία και την αποδοχή των ασθενών."
            },

            q2: {
                "1": "Παρέχονται λίγες πληροφορίες σχετικά με τις υπηρεσίες τηλε-υγείας, και οι περισσότερες βρίσκονται στο διαδίκτυο.",
                "2": "Πληροφορίες σχετικά με τις υπηρεσίες τηλε-υγείας είναι διαθέσιμες εντός και εκτός διαδικτύου.",
                "3": "Παρέχονται πληροφορίες σχετικά με τις υπηρεσίες τηλε-υγείας και υπάρχει ένας σχετικός μη δομημένος μηχανισμός ανατροφοδότησης.",
                "4": "Παρέχονται πληροφορίες και υπάρχει ένας επιπλέον μηχανισμός που επιτρέπει στον οργανισμό να λαμβάνει στοιχεία σχετικά με την κατανόηση των πληροφοριών αυτών από τους ασθενείς.",
                "5": "Παρέχονται πληροφορίες σχετικά με τις υπηρεσίες τηλε-υγείας, μετράται η κατανόηση των ασθενών και αξιολογούνται τα επίπεδα εμπιστοσύνης στις υπηρεσίες τηλε-υγείας."
            },  
            
            q3: {
                "1": "Δεν υπάρχει καμία καθοδήγηση ή κανένας μηχανισμός.",
                "2": "Υπάρχουν γενικές οδηγίες για την ενημέρωση των ασθενών σχετικά με τις υπηρεσίες υγείας.",
                "3": "Υπάρχουν κατευθυντήριες οδηγίες για τους παρόχους υπηρεσιών τηλε-υγείας και απαίτηση για τη σύναψη συμβάσεων.",
                "4": "Οι μετρικές συλλέγονται σε οργανωτικό επίπεδο με τη χρήση εθνικών υποδείξεων.",
                "5": "Οι οργανωτικοί μηχανισμοί συλλογής δεδομένων για την καταγραφή της εμπειρίας των ασθενών είναι συνδεδεμένοι με εθνικές πλατφόρμες και υπάρχει πλήρης συμμόρφωση με τις εθνικές οδηγίες."
            },    
            
            q4: {
                "1": "Δεν υπάρχει ειδική υποδομή σχετικά με την τηλε-υγεία ή δεν έχει προσδιοριστεί ως τέτοιου είδους υποδομή.",
                "2": "Έχει εκπονηθεί σχέδιο για τον χαρακτηρισμό και την περαιτέρω βελτίωσης της υποδομής.",
                "3": "Οι υποδομές έχουν προσαρμοστεί μερικώς για την υποστήριξη των υπηρεσιών τηλε-υγείας.",
                "4": "Οι υποδομές έχουν προσαρμοστεί σύμφωνα με τις εθνικές και διεθνείς οδηγίες.",
                "5": "Οι υποδομές έχουν προσαρμοστεί σύμφωνα με τις εθνικές και διεθνείς κατευθυντήριες γραμμές, και υπάρχουν λογισμικό και κανόνες που είναι εξειδικευμένοι για ορισμένες υπηρεσίες τηλε-υγείας."
            }, 
            
            q5: {
                "1": "Υπάρχει ένας μηχανισμός για την εκπαίδευση των ασθενών σχετικά με τις υπηρεσίες τηλε-υγείας.",
                "2": "Υπάρχει ένας μηχανισμός για την διασφάλιση της προώθησης του ψηφιακού αλφαβητισμού από τους οργανισμούς.",
                "3": "Έχουν προσδιοριστεί τοπικές διαδικασίες, οι οποίες εξετάζουν το επίπεδο ψηφιακού αλφαβητισμού των χρηστών και τους μηχανισμούς για τη βελτίωσή του.",
                "4": "Οι τοπικές διαδικασίες βασίζονται στις υφιστάμενες εθνικές κατευθυντήριες οδηγίες σχετικά με τον ψηφιακό αλφαβητισμό.",
                "5": "Εκτός από τις τοπικές διαδικασίες και την τήρηση των κατευθυντήριων οδηγιών, ο οργανισμός οφείλει να ευαισθητοποιεί τους επαγγελματίες ως προς το ρόλο τους στη συμβολή τους στον ψηφιακή αλφαβητισμό στον τομέα της υγείας."
            }, 
            
            q6: {
                "1": "Δεν έχει πραγματοποιηθεί καμία ειδική δράση για την επικοινωνία.",
                "2": "Λαμβάνονται υπόψη ορισμένα στοιχεία της γενικής καθοδήγησης σχετικά με την καλή επικοινωνία στην τηλε-υγεία.",
                "3": "Λαμβάνονται υπόψη οι υπάρχουσες οδηγίες, συμπεριλαμβανομένων πτυχών όπως η προσβασιμότητα και η τήρηση των εθνικών ή περιφερειακών οδηγιών.",
                "4": "Η ευαισθητοποίηση των επαγγελματιών υγείας αναφορικά με την ορθή επικοινωνία στην τηλε-υγεία είναι συμπληρωματική της τήρησης των εθνικών κατευθυντήριων γραμμών από τον οργανισμό.",
                "5": "Τηρούνται οι εθνικές κατευθυντήριες γραμμές, εφαρμόζονται εκπαιδευτικές προσπάθειες και αξιολογούνται οι ικανότητες των επαγγελματιών, ώστε να διασφαλίζονται οι καλές επικοινωνιακές δεξιότητες του σχετικού υγειονομικού προσωπικού."
            },   
            
            q7: {
                "1": "Δεν έχει πραγματοποιηθεί καμία ειδική δράση για την επικοινωνία.",
                "2": "Λαμβάνονται υπόψη ορισμένα στοιχεία της γενικής καθοδήγησης σχετικά με την καλή επικοινωνία στην τηλε-υγεία.",
                "3": "Λαμβάνονται υπόψη οι υπάρχουσες κατευθυντήριες οδηγίες, ορισμένες πτυχές όπως η προσβασιμότητα, οι ειδικές διαδικασίες, ακόμη και οι απαιτήσεις της πλατφόρμας τηλε-υγείας, οι οποίες οφείλουν ακολουθούν τις εθνικές/περιφερειακές απαιτήσεις, όταν αυτές υπάρχουν.",
                "4": "Η ευαισθητοποίηση των επαγγελματιών υγείας αναφορικά με την ορθή επικοινωνία στην τηλε-υγεία είναι συμπληρωματική της τήρησης των εθνικών κατευθυντήριων γραμμών από τον οργανισμό.",
                "5": "Τηρούνται εθνικές κατευθυντήριες οδηγίες, γίνονται εκπαιδευτικές προσπάθειες και αξιολογείται η ικανότητα των επαγγελματιών, ώστε να διασφαλιστούν οι καλές επικοινωνιακές δεξιότητες του εργατικού δυναμικού της τηλε-υγείας."
            }, 
            
            q8: {
                "1": "Δεν έχει πραγματοποιηθεί καμία ειδική δράση για την εκπαίδευση και την ανάπτυξη των ικανοτήτων των επαγγελματικών ομάδων.",
                "2": "Προσπάθειες του οργανισμού για την εκπαίδευση των επαγγελματιών σε μια ομάδα σχετικά με την τηλε-υγεία υπάρχουν, αλλά δεν είναι οργανωμένες ή δεν διεξάγονται με συστηματικό τρόπο.",
                "3": "Υπάρχουν δραστηριότητες για την ενίσχυση της εκπαίδευσης και της ανάπτυξης ικανοτήτων των επαγγελματιών σχετικά με την τηλε-υγεία και τον τρόπο παροχής αυτών των υπηρεσιών, ακολουθώντας τις σχετικές εθνικές οδηγίες, όταν αυτό είναι δυνατόν. Υπάρχουν διαδικασίες για την ενσωμάτωση των υπηρεσιών τηλε-υγείας στις οργανωτικές και δια-οργανωτικές ροές εργασίας.",
                "4": "Η ανάπτυξη δυνατοτήτων σχετικά με την τηλε-υγεία και οι προσαρμογές της ροής εργασίας γενικεύονται και εναρμονίζονται σε ολόκληρο τον οργανισμό. Η πρόοδος στην ενίσχυση των γνώσεων, των στάσεων και των δεξιοτήτων του υγειονομικού προσωπικού σχετικά με την τηλε-υγεία και η ικανότητά του να χρησιμοποιείται για να συμβάλει στην παροχή υψηλής ποιότητας υπηρεσιών,αξιολογείται με προκαθορισμένες μετρήσεις.",
                "5": "Ακολουθούνται όλες οι εθνικές κατευθυντήριες γραμμές, αναλαμβάνονται εκπαιδευτικές προσπάθειες, προσαρμόζονται κατάλληλα οι ροές εργασίας και αξιολογείται τακτικά η ικανότητα των επαγγελματιών στην τηλε-υγεία."
            },    
            
            q9: {
                "1": "Δεν υπάρχει καθοδήγηση.",
                "2": "Εφαρμόζεται γενική καθοδήγηση σχετικά με την προώθηση και το μάρκετινγκ.",
                "3": "Ειδική καθοδήγηση για την τηλε-υγεία εφαρμόζεται σε όλες τις υπηρεσίες του οργανισμού.",
                "4": "Ειδική καθοδήγηση για την τηλε-υγεία εφαρμόζεται και υπάρχουν εκπαιδευτικές προσπάθειες που στοχεύουν στην ανήθικη προώθηση και μάρκετινγκ.",
                "5": "Οι κατευθυντήριες γραμμές ακολουθούνται, οι εκπαιδευτικές προσπάθειες είναι ευρέως αποδεκτές και υπάρχει μηχανισμός επαλήθευσης για τον έλεγχο της συμμόρφωσης."
            },  

            q10: {
                "1": "Δεν υπάρχει σχέδιο ανάπτυξης του εργατικού δυναμικού.",
                "2": "Υπάρχει ένα γενικό σχέδιο ανάπτυξης του εργατικού δυναμικού, το οποίο περιλαμβάνει συγκεκριμένες πτυχές που αφορούν την τεχνολογία πληροφοριών και επικοινωνιών, καθώς και την ψηφιακή υγεία.",
                "3": "Υπάρχει σχέδιο ανάπτυξης του εργατικού δυναμικού, το οποίο περιλαμβάνει σαφώς καθορισμένους στόχους και δραστηριότητες που αφορούν την τηλε-υγεία, ακολουθώντας τις υφιστάμενες υπερ-οργανωτικές κατευθυντήριες οδηγίες.",
                "4": "Η κατάρτιση σε θέματα τηλε-υγείας διεξάγεται σε τακτική βάση για όλο το προσωπικό που συμμετέχει στις υπηρεσίες τηλε-υγείας, με ιδιαίτερη έμφαση στην ποιότητα και την αξιοπιστία από την πλευρά των επαγγελματιών υγείας.",
                "5": "Η διασφάλιση της ποιότητας μιας κατάλληλης και προσαρμοσμένης κατάρτισης σε θέματα τηλε-υγείας για τους επαγγελματίες υγείας υπάρχει και ακολουθεί τις εθνικές προδιαγραφές."
            },  
            
            q11: {
                "1": "Δεν πραγματοποιείται καμία μέτρηση της διαγνωστικής ακρίβειας της τηλε-υγείας.",
                "2": "Η διαγνωστική ακρίβεια της τηλε-υγείας αναλύεται σε ερευνητικά ή πιλοτικά πλαίσια.",
                "3": "Παράγονται στοιχεία διασποράς σχετικά με τη διαγνωστική ακρίβεια των υπηρεσιών τηλε-υγείας.",
                "4": "Σχεδόν για όλες τις υπηρεσίες διατίθενται στοιχεία για τη διαγνωστική ακρίβεια.",
                "5": "Συστηματικά στοιχεία σχετικά με τη διαγνωστική ακρίβεια της τηλε-υγείας συλλέγονται τακτικά και ακολουθούν εθνικές ή περιφερειακές κατευθυντήριες οδηγίες."
            }, 
            
            q12: {
                "1": "Δεν πραγματοποιείται μέτρηση των επιπτώσεων της τηλε-υγείας.",
                "2": "Οι επιπτώσεις των υπηρεσιών τηλεϊατρικής μελετώνται περιστασιακά σε ερευνητικά ή πιλοτικά πλαίσια ή με έναν ad-hoc, μη συστηματικό τρόπο.",
                "3": "Στοιχεία για τις επιπτώσεις της τηλε-υγείας συλλέγονται για ορισμένες υπηρεσίες με ακανόνιστο τρόπο, αλλά ακολουθούν τις εθνικές ή τις διεθνείς κατευθυντήριες γραμμές όταν δεν υπάρχουν εθνικές κατευθυντήριες γραμμές.",
                "4": "Στοιχεία λαμβάνονται για τουλαχιστόν το 90% των υπηρεσιών και με καθορισμένο τρόπο σύμφωνα με τις εθνικές οδηγίες.",
                "5": "Στοιχεία συλλέγονται συστηματικά για όλες τις υπηρεσίες, ακολουθούν τις εθνικές ή περιφερειακές οδηγίες, αναλύονται και διαμορφώνεται επίσημα ένα σχέδιο βελτίωσης."
            },   
            
            q13: {
                "1": "Δεν πραγματοποιείται συστηματική μέτρηση της χρήσης των υπηρεσιών.",
                "2": "Ο οργανισμός ακολουθεί την εθνική καθοδήγηση για τη μέτρηση της χρήσης των υπηρεσιών, αλλά δεν παράγονται συγκεκριμένα στατιστικά στοιχεία για τις υπηρεσίες τηλε-υγείας.",
                "3": "Παράγονται μέτρα διασποράς, τα οποία αφορούν τη χρήση υπηρεσιών τηλε-υγείας και σχετίζονται με άλλα πρότυπα χρήσης υπηρεσιών.",
                "4": "Τα στοιχεία σχετικά με τη χρήση των υπηρεσιών τηλε-υγείας προέρχονται από το 90% των υπηρεσιών και σχέτιζονται με άλλα πρότυπα χρήσης υπηρεσιών.",
                "5": "Η συστηματική καταγραφή των επιπτώσεων της παροχής τηλε-υγείας στη χρήση άλλων υπηρεσιών ακολουθεί την εθνική καθοδήγηση και αναφέρεται σε εθνικό επίπεδο."
            },  
        
            q14: {
                "1": "Δεν υπάρχουν κατευθυντήριες οδηγίες.",
                "2": "Υπάρχουν διεθνείς κατευθυντήριες γραμμές για την ασφάλεια στον κυβερνοχώρο και την ασφάλεια των πληροφορίων.",
                "3": "Υπάρχει ειδική καθοδήγηση για τις υπηρεσίες τηλε-υγείας.",
                "4": "Υπάρχει καθοδήγηση και μηχανισμός ειδικά για τις υπηρεσίες τηλε-υγείας.",
                "5": "Υπάρχει καθοδήγηση, μηχανισμός και εκπαίδευση για τους ασθενείς και τους επαγγελματίες υγείας."
            },  
            
            q15: {
                "1": "Δεν υπάρχουν κατευθυντήριες οδηγίες.",
                "2": "Υπάρχουν γενικές κατευθυντήριες γραμμές για την ψυχολογική και συναισθηματική ασφάλεια στην υγειονομική περίθαλψη.",
                "3": "Δημιουργείται εξειδικευμένη πολιτική για την ψυχολογική και συναισθηματική ασφάλεια στον τομέα της τηλε-υγείας.",
                "4": "Υπάρχουν ειδικές κατευθυντήριες γραμμές για την τηλε-υγεία με εκπαιδευτικές δραστηριότητες για τους επαγγελματίες και ένα σύστημα παραπόνων.",
                "5": "Υπάρχουν κατευθυντήριες γραμμές και ένας μηχανισμός για τη διασφάλιση της ψυχολογικής και συναισθηματικής ασφάλειας στις υπηρεσίες τηλε-υγείας."
            },   
            
            q16: {
                "1": "Δεν υπάρχει σύστημα διακυβέρνησης.",
                "2": "Δεν υπάρχει ειδικός συντονιστής τηλε-υγείας και το ρόλο αυτό αναλαμβάνει ένας κλινικός διευθυντής ή ένας διευθυντής πληροφορικής.",
                "3": "Υπάρχει ειδικός συντονιστής τηλε-υγείας.",
                "4": "Υπάρχει ένα ολοκληρωμένο σύστημα διακυβέρνησης της τηλε-υγείας.",
                "5": "Το σύστημα διακυβέρνησης της τηλε-υγείας είναι ώριμο και παρέχεται ειδική κατάρτιση στο προσωπικό σχετικά με αυτό."
            }          
        };

        async function fetchUserAnswers() {
            const userId = sessionStorage.getItem("userId");
            const scriptUrl = "https://script.google.com/macros/s/AKfycbwLq4GsrjigTjy0bgF1_czclUcgk9icc9oUw0GcLk-8fDzhgvrYkrBXKU3eEktmxkTI/exec";

            showSpinners();

            try {
                const response = await fetch(`${scriptUrl}?userId=${encodeURIComponent(userId)}`);
                const data = await response.json();
                fetchedAnswers = data;
                displayAnswers(data); // Εμφάνιση των απαντήσεων στη σελίδα

            } catch (error) {
                console.error("Σφάλμα κατά την ανάκτηση των απαντήσεων:", error);
            } finally {
                // Απόκρυψη spinner
                hideSpinners();
            }
        }

        function displayAnswers(answersArray) {
            console.log("Απαντήσεις που ελήφθησαν:", answersArray);

            // Ταξινόμηση με βάση το timestamp (το πιο πρόσφατο πρώτο)
            answersArray.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            // Παίρνουμε την πιο πρόσφατη εγγραφή
            const answers = answersArray[0];

            // Καθαρίζουμε κενά από τα keys
            const cleanedAnswers = {};
            Object.keys(answers).forEach(key => {
                cleanedAnswers[key.trim()] = answers[key];
            });

            // Κατηγορίες: Ανά Ερωτηματολόγιο
            const individualScoresList = document.getElementById("individualScores");
            individualScoresList.innerHTML = ""; // Καθαρίζει παλιά αποτελέσματα

            const categories = {
                "Ανθρωποκεντρικότητα": cleanedAnswers.category1 || "Δεν υπάρχουν δεδομένα",
                "Κλινική Αποτελεσματικότητα": cleanedAnswers.category2 || "Δεν υπάρχουν δεδομένα",
                "Ασφάλεια και Απόρρητο": cleanedAnswers.category3 || "Δεν υπάρχουν δεδομένα",
            };

            // Συνάρτηση για καθορισμό επιπέδου και χρώματος
            function getLevel(score, ranges) {
                if (score <= ranges.lowMax) {
                    return { label: "Χαμηλό", color: "#FF4C4C" };
                } else if (score <= ranges.mediumMax) {
                    return { label: "Μέτριο", color: "#FF8C00" };
                } else {
                    return { label: "Υψηλό", color: "#32CD32" };
                }
            }

            const score1 = parseInt(cleanedAnswers.category1);
            const score2 = parseInt(cleanedAnswers.category2);
            const score3 = parseInt(cleanedAnswers.category3);
            const totalScore = parseInt(cleanedAnswers.totalScore);

            const level1 = getLevel(score1, { lowMax: 20, mediumMax: 32 });
            const level2 = getLevel(score2, { lowMax: 9, mediumMax: 15 });
            const level3 = getLevel(score3, { lowMax: 7, mediumMax: 11 });
            const totalLevel = getLevel(totalScore, { lowMax: 36, mediumMax: 59 });


            const levels = [level1, level2, level3];
            let i = 0;
            Object.entries(categories).forEach(([categoryName, score]) => {
                const level = levels[i++];
                const listItem = document.createElement("li");
                listItem.innerHTML = `<strong>${categoryName}</strong>: Σκορ: ${score} 
                    <span style="color: ${level.color}; font-weight: bold;">(${level.label})</span>`;
                individualScoresList.appendChild(listItem);
            });


            const container = document.getElementById('answersDisplay');
            // Ερωτήσεις - Απαντήσεις
            //container.innerHTML += "<h3>Ερωτήσεις και Απαντήσεις:</h3><ul>";
            for (let i = 1; i <= 16; i++) {
                const qKey = `q${i}`;
                const value = cleanedAnswers[qKey];
                const title = questionTitles[qKey] || qKey;
                const fullAnswer = answerTexts[qKey]?.[value] || "-";

                container.innerHTML += `
                    <strong>Ερώτηση:</strong> ${title}<br>
                        <strong>Απάντηση:</strong> ${fullAnswer} <br> <br>
                `;
            }
            container.innerHTML += "</ul>";

            // Συνολικό σκορ
            const totalScoreContainer = document.getElementById('totalScore');
            totalScoreContainer.innerHTML = `Συνολική Βαθμολογία: <strong>${totalScore}</strong> 
            <span style="color: ${totalLevel.color}; font-weight: bold;">(${totalLevel.label})</span>`;

        }



        window.onload = function() {
            fetchUserAnswers(); // Φόρτωση των απαντήσεων κατά την φόρτωση της σελίδας
        };

        function repeatQuestionnaire(){
            setTimeout(function() {
                // Ανακατεύθυνση στο δεύτερο ερωτηματολόγιο
                 window.location.href = 'page2.html';  // Αντικαταστήστε με τη διεύθυνση του δεύτερου ερωτηματολογίου
            }, 1500);
        }

        function exportToCSV() {
            if (!fetchedAnswers.length) return alert("Δεν υπάρχουν απαντήσεις προς εξαγωγή.");

            const headers = Object.keys(fetchedAnswers[0]);
            const csvRows = [headers.join(",")];

            fetchedAnswers.forEach(obj => {
                const row = headers.map(key => `"${(obj[key] || "").toString().replace(/"/g, '""')}"`);
                csvRows.push(row.join(","));
            });

            const csvContent = csvRows.join("\n");
            const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "apantiseis_oloi.csv";
            link.click();
        }

        function exportToTXT() {
            if (!fetchedAnswers.length) return alert("Δεν υπάρχουν απαντήσεις προς εξαγωγή.");

            let txtContent = "";

            fetchedAnswers.forEach((entry, index) => {
                txtContent += `--- Εγγραφή ${index + 1} ---\n`;
                Object.entries(entry).forEach(([key, value]) => {
                    txtContent += `${key}: ${value}\n`;
                });
                txtContent += "\n";
            });

            const blob = new Blob([txtContent], { type: "text/plain;charset=utf-8;" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "apantiseis_oloi.txt";
            link.click();
        }

        function exportToPDF() {
            if (!fetchedAnswers.length) return alert("Δεν υπάρχουν απαντήσεις προς εξαγωγή.");

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let y = 20;

            doc.setFontSize(16);
            doc.text("Απαντήσεις Χρήστη", 14, 15);

            fetchedAnswers.forEach((entry, index) => {
                doc.setFontSize(12);
                doc.text(`Εγγραφή ${index + 1}`, 14, y);
                y += 7;

                Object.entries(entry).forEach(([key, value]) => {
                    doc.text(`${key}: ${value}`, 14, y);
                    y += 6;

                    if (y > 270) {
                        doc.addPage();
                        y = 20;
                    }
                });

                y += 10;
            });

            doc.save("apantiseis_oloi.pdf");
        }

    function showSpinners() {
        document.querySelectorAll('.spinner-wrapper').forEach(el => {
        el.style.display = 'flex';
        });
    }

    function hideSpinners() {
        document.querySelectorAll('.spinner-wrapper').forEach(el => {
        el.style.display = 'none';
        });
    }

    </script>
</body>
</html>